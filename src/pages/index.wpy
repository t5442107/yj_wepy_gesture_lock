<style lang="less">
page {
  background-color: #445c95;
  height: 100%;
}

.sample {
  width: 100%;
  margin: 0;
  padding: 0;
  text-align: center;
  margin-bottom: 80rpx;
}

.gesture-lock {
  background-color: #445c95;
  margin-left: 20px;
  margin-top: 100px;
}

.gesture-lock-sample {
  margin: 10rpx auto;
  background-color: #445c95;
}

.avatar-wrap {
  margin-bottom: 40rpx;
  text-align: center;
}

.avatar-people {
  width: 124rpx;
  height: 124rpx;
  overflow: hidden;
  border: 1px solid #445c95;
  border-radius: 124rpx;
  background-size: contain;
}

.nickname {
  color: #f0f0f0;
  font-size: 28rpx;
  height: 32rpx;
  margin-top: 20rpx;
  padding-bottom: 10rpx;
}

.errmsg {
  color: #f29360;
  font-size: 28rpx;
  height: 32rpx;
  margin-top: 20rpx;
  padding-bottom: 10rpx;
}

.zhiwen-pic {
  height: 96rpx;
  width: 96rpx;
  margin-top: 120rpx;
}

.zhiwen-txt {
  color: #90aae1;
  font-size: 24rpx;
  margin-top: 10rpx;
}

.bt-choice {
  color: #a0bcff;
  font-size: 28rpx;
  line-height: 48rpx;
  margin-top: 40rpx;
}
.pop-bg {
  height: 100%;
  width: 100%;
  position: fixed;
  top: 0;
  left: 0;
  z-index: 10;
  background-color: rgba(0, 0, 0, 0.5);
}

.pop {
  border-radius: 12rpx;
  width: 540rpx;
  max-height: 72%;
  color: #374b79;
  box-shadow: 0 0 12rpx rgba(12, 2, 3, 0.6);
  background: #fff;
  overflow: hidden;
}

.pop .hd {
  position: relative;
  height: 88rpx;
  line-height: 88rpx;
  text-align: center;
  color: #445c95;
}

.pop .hd .close {
  position: absolute;
  width: 60rpx;
  height: 60rpx;
  top: 16rpx;
  right: 16rpx;
}

.pop .hd .close::before {
  content: '';
  display: block;
  width: 32rpx;
  height: 32rpx;
  margin: 12rpx 0 0 10rpx;
  background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAGFBMVEUAAACsssGsssGsssGsssGsssGsssGsssFAXB5+AAAAB3RSTlMAAZCRz35UDYuIxAAAALFJREFUOMu90zsKwzAQhOG4SS2cE7hKnSonCLlAIG269Hl4r2/QDgziZ1ur0cqaz6CFPeyzjrc2fpger76/Yxkv5lj7fo9PG8A5fr14RhKD+PfiFEkM4pLVNYnBVzkTAxMAEwARAWdMBBQxITARIBEAESARIBEgESARACFQl4qL2b8CIFGX8vkEizoG0CYSdYlEXRIBEAFwAsARnJzxgcS1UwCOuQIpBqcYtWo463HeZW3YbWRo9Hmb0wAAAABJRU5ErkJggg==')
    center / contain no-repeat;
}

.pop .qx-box {
  position: relative;
  padding: 30rpx;
  text-align: left;
}

.pop .qx-v {
  font-size: 32rpx;
  line-height: 44rpx;
  padding: 20rpx 0;
}

.pop .qx-s {
  display: block;
}

.pop .qx-k {
  padding: 0 20rpx 20rpx;
  font-size: 24rpx;
  color: #acb2c1;
  text-align: center;
}

.pop .qx-m {
  padding: 40rpx;
  font-size: 28rpx;
  color: #acb2c1;
  text-align: center;
}

.qx-box .dd {
  color: #acb2c1;
  padding-top: 30rpx;
}

.qx-box .dd .wd {
  color: #374b79;
  font-size: 32rpx;
}

.qx-box .qx-icon {
  display: block;
  margin: 0 auto;
  height: 64rpx;
  width: 64rpx;
}

.qx-box .qx-msg {
  font-size: 32rpx;
  font-weight: bold;
  padding: 30rpx 0;
  text-align: center;
}

.qx-box .qx-desc {
  padding-bottom: 10rpx;
  min-height: 46rpx;
  max-height: 400rpx;
  line-height: 36rpx;
  font-size: 28rpx;
  word-wrap: break-word;
  word-break: break-all;
}

.pop .qx-menu {
  height: 88rpx;
  line-height: 88rpx;
  text-align: center;
  color: #3399eb;
}

.qx-menu .item {
  font-size: 32rpx;
}

.qx-menu button.item {
  line-height: 88rpx;
  border-width: 0;
  border-style: none;
  border-radius: 0;
  padding: 0;
  background-color: #ffffff;
}

.pop-bg .pop {
  animation: scaleOut 0.1s ease-in-out both;
}

.pop-bg.active .pop {
  animation: scaleIn 0.2s ease-in-out both;
}

@-webkit-keyframes scaleIn {
  from {
    -webkit-transform: scale(0.8);
    opacity: 0;
  }

  to {
    -webkit-transform: scale(1);
    opacity: 1;
  }
}

@keyframes scaleIn {
  from {
    transform: scale(0.8);
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

button[plain].plain-button-hover {
  background-color: rgba(0, 0, 0, 0.1);
  opacity: 0.7;
}
.ui-password-bg {
  background: rgba(0, 0, 0, 0.5);
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  overflow: hidden;
  z-index: 9;
}

.ui-password-keyboard {
  width: 100%;
  box-sizing: border-box;
  background: #fff;
}

.ui-password-keyboard .table {
  width: 100%;
}

.ui-password-keyboard .table .td {
  height: 108rpx;
  line-height: 108rpx;
  text-align: center;
  color: #000;
  font-size: 52rpx;
  cursor: pointer;
}

.ui-password-keyboard .table .o,
.ui-password-keyboard .table .del {
  background-color: #f3f3f3;
}

.del {
  background-size: 44rpx 30rpx;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAgCAMAAABuFHtpAAAAM1BMVEUAAABRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVEMnAvmAAAAEHRSTlMAYgvDwtmkJfKtFITz77mAEh2agwAAAJtJREFUOMud1csOgyAUhOGhVY54aef9n7YLCEmnoer8G918IdwCvnts08KTlhKqJl7pCEeRxVLcLUV6ip6ipzhWc+6/eaY0VisSawmruqqe/CkDSE0BWVlXWqqufSVV6lS1VKmLroRt5B/XlbIXxwWAoGSMZs7NX0l/3/xT0pxxJqszbkB1N4Ln4Dl4DpbbYbkCxx0Bce9rL47ZB97tUPSGlHObAAAAAElFTkSuQmCC');
  background-repeat: no-repeat;
  background-position: center center;
}

.register .ui-password-keyboard {
  position: fixed;
  left: 0;
  bottom: 0;
}

.ui-action-sheet .action-sheet-content .ui-password-keyboard {
  position: absolute;
  bottom: 0;
}

.ui-view-ix .ui-password-bg {
  border-bottom: 34px solid #f3f3f3;
}
</style>
<template>

  <canvas
    disableScroll
    binderror="onBigCanvasError"
    bindtouchend="onTouchEnd"
    bindtouchmove="onTouchMove"
    bindtouchstart="onTouchStart"
    canvasId="id-gesture-lock"
    class="gesture-lock"
    style="width:{{wWidth}}px;height:{{hHeight}}px;"
  ></canvas>

</template> 

<script>
import wepy from 'wepy';

import GestureLock from '../components/yj_gesture_lock.js';

export default class Index extends wepy.page {
  config = {
    navigationBarTitleText: 'yj 最强手势密码'
  };
  components = {};

  data = {
    wWidth: 375,
    hHeight: 375,
    settingGesturePasswordTip: '',
    settingGesturePasswordErrTip: '',
    handlePassWordType: 0,
    lock: null
  };

  computed = {
    now() {
      return +new Date();
    }
  };

  methods = {
    onTouchStart: function(e) {
      this.lock.onTouchStart(e);
    },
    onTouchMove: function(e) {
      this.lock.onTouchMove(e);
    },
    onTouchEnd: function(e) {
      this.lock.onTouchEnd(e);
    },
    onSimpleCanvasError: function(e) {
      console.error(e.detail.errMsg);
    },
    onBigCanvasError: function(e) {
      console.error(e.detail.errMsg);
    }
  };

  onLoad() { 
    var lock = new GestureLock(
      'id-gesture-lock',
      wepy.createCanvasContext('id-gesture-lock'),
      function(t, a) {
        setTimeout(() => { 
          this.reset();
        }, 500);

        console.log('tt=', t);
        console.log('aa=', a);
      },
      {
        width: 299,
        height: 299,
        margeCircle: parseInt(35 * 1.1),
        pointlineWidth: 3,
        circleCentreRadius: 8
      }
    );
    lock.drawGestureLock();
    this.lock = lock;
  }
}
</script>
